{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/JuanD/JuanD/respaldo002/cyg/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/JuanD/JuanD/respaldo002/cyg/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:/Users/JuanD/JuanD/respaldo002/cyg/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/JuanD/JuanD/respaldo002/cyg/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/JuanD/JuanD/respaldo002/cyg/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import Layout from'../../hocs/Layout';import{Navigate}from'react-router';import{connect}from'react-redux';import{Link}from'react-router-dom';import CartItem from'../../components/cart/CartItem';import{setAlert}from'../../redux/actions/alert';import{update_item,remove_item}from'../../redux/actions/cart';import{useEffect,useState}from'react';import{get_shipping_options}from'../../redux/actions/shipping';import{check_coupon}from'../../redux/actions/coupons';import{refresh}from'../../redux/actions/auth';import{get_payment_total,get_client_token,process_payment}from'../../redux/actions/payment';import DropIn from'braintree-web-drop-in-react';import Loader from'react-loader-spinner';import{countries}from'../../helpers/fixedCountries';import ShippingForm from'../../components/checkout/ShippingForm';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Checkout=function Checkout(_ref){var isAuthenticated=_ref.isAuthenticated,items=_ref.items,update_item=_ref.update_item,remove_item=_ref.remove_item,setAlert=_ref.setAlert,get_shipping_options=_ref.get_shipping_options,shipping=_ref.shipping,refresh=_ref.refresh,get_payment_total=_ref.get_payment_total,get_client_token=_ref.get_client_token,process_payment=_ref.process_payment,user=_ref.user,total_items=_ref.total_items,clientToken=_ref.clientToken,made_payment=_ref.made_payment,loading=_ref.loading,original_price=_ref.original_price,total_after_coupon=_ref.total_after_coupon,total_amount=_ref.total_amount,total_compare_amount=_ref.total_compare_amount,estimated_tax=_ref.estimated_tax,shipping_cost=_ref.shipping_cost,check_coupon=_ref.check_coupon,coupon=_ref.coupon;var _useState=useState({full_name:'',address_line_1:'',address_line_2:'',city:'',state_province_region:'',postal_zip_code:'',country_region:'Peru',telephone_number:'',coupon_name:'',shipping_id:0}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState({instance:{}}),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var full_name=formData.full_name,address_line_1=formData.address_line_1,address_line_2=formData.address_line_2,city=formData.city,state_province_region=formData.state_province_region,postal_zip_code=formData.postal_zip_code,country_region=formData.country_region,telephone_number=formData.telephone_number,coupon_name=formData.coupon_name,shipping_id=formData.shipping_id;var _onChange=function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},e.target.name,e.target.value)));};var buy=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var nonce;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.next=3;return data.instance.requestPaymentMethod();case 3:nonce=_context.sent;if(coupon&&coupon!==null&&coupon!==undefined){process_payment(nonce,shipping_id,coupon.name,full_name,address_line_1,address_line_2,city,state_province_region,postal_zip_code,country_region,telephone_number);}else{process_payment(nonce,shipping_id,'',full_name,address_line_1,address_line_2,city,state_province_region,postal_zip_code,country_region,telephone_number);}case 5:case\"end\":return _context.stop();}}},_callee);}));return function buy(_x){return _ref2.apply(this,arguments);};}();var apply_coupon=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();check_coupon(coupon_name);case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function apply_coupon(_x2){return _ref3.apply(this,arguments);};}();useEffect(function(){window.scrollTo(0,0);get_shipping_options();},[]);useEffect(function(){get_client_token();},[user]);useEffect(function(){if(coupon&&coupon!==null&&coupon!==undefined)get_payment_total(shipping_id,coupon.name);else get_payment_total(shipping_id,'default');},[shipping_id,coupon]);var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),render=_useState6[0],setRender=_useState6[1];if(!isAuthenticated)return/*#__PURE__*/_jsx(Navigate,{to:\"/\"});var showItems=function showItems(){return/*#__PURE__*/_jsx(\"div\",{children:items&&items!==null&&items!==undefined&&items.length!==0&&items.map(function(item,index){var count=item.count;return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CartItem,{item:item,count:count,update_item:update_item,remove_item:remove_item,render:render,setRender:setRender,setAlert:setAlert})},index);})});};var renderShipping=function renderShipping(){if(shipping&&shipping!==null&&shipping!==undefined){return/*#__PURE__*/_jsx(\"div\",{className:\"mb-5\",children:shipping.map(function(shipping_option,index){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return _onChange(e);},value:shipping_option.id,name:\"shipping_id\",type:\"radio\",required:true}),/*#__PURE__*/_jsxs(\"label\",{className:\"ml-4\",children:[shipping_option.name,\" - $\",shipping_option.price,\" (\",shipping_option.time_to_delivery,\")\"]})]},index);})});}};var renderPaymentInfo=function renderPaymentInfo(){if(!clientToken){if(!isAuthenticated){/*#__PURE__*/_jsx(Link,{to:\"/login\",className:\"w-full bg-gray-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-gray-500\",children:\"Login\"});}else{/*#__PURE__*/_jsx(\"button\",{className:\"w-full bg-indigo-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-indigo-500\",children:/*#__PURE__*/_jsx(Loader,{type:\"Oval\",color:\"#fff\",height:20,widht:20})});}}else{return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(DropIn,{options:{authorization:clientToken,paypal:{flow:'vault'}},onInstance:function onInstance(instance){return data.instance=instance;}}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6\",children:loading?/*#__PURE__*/_jsx(\"button\",{className:\"w-full bg-indigo-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-indigo-500\",children:/*#__PURE__*/_jsx(Loader,{type:\"Oval\",color:\"#fff\",height:20,widht:20})}):/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-full bg-green-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-green-500\",children:\"Place Order\"})})]});}};if(made_payment)return/*#__PURE__*/_jsx(Navigate,{to:\"/thankyou\"});return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto pt-16 pb-24 px-4 sm:px-6 lg:max-w-7xl lg:px-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-extrabold tracking-tight text-gray-900 sm:text-4xl\",children:\"Checkout\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-12 lg:grid lg:grid-cols-12 lg:gap-x-12 lg:items-start xl:gap-x-16\",children:[/*#__PURE__*/_jsxs(\"section\",{\"aria-labelledby\":\"cart-heading\",className:\"lg:col-span-7\",children:[/*#__PURE__*/_jsx(\"h2\",{id:\"cart-heading\",className:\"sr-only\",children:\"Items in your shopping cart\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"border-t border-b border-gray-200 divide-y divide-gray-200\",children:showItems()})]}),/*#__PURE__*/_jsx(ShippingForm,{full_name:full_name,address_line_1:address_line_1,address_line_2:address_line_2,city:city,state_province_region:state_province_region,postal_zip_code:postal_zip_code,telephone_number:telephone_number,countries:countries,onChange:_onChange,buy:buy,user:user,renderShipping:renderShipping,total_amount:total_amount,total_after_coupon:total_after_coupon,total_compare_amount:total_compare_amount,estimated_tax:estimated_tax,shipping_cost:shipping_cost,shipping_id:shipping_id,shipping:shipping,renderPaymentInfo:renderPaymentInfo,coupon:coupon,apply_coupon:apply_coupon,coupon_name:coupon_name})]})]})})});};var mapStateToProps=function mapStateToProps(state){return{isAuthenticated:state.Auth.isAuthenticated,user:state.Auth.user,items:state.Cart.items,total_items:state.Cart.total_items,shipping:state.Shipping.shipping,clientToken:state.Payment.clientToken,made_payment:state.Payment.made_payment,loading:state.Payment.loading,original_price:state.Payment.original_price,total_after_coupon:state.Payment.total_after_coupon,total_amount:state.Payment.total_amount,total_compare_amount:state.Payment.total_compare_amount,estimated_tax:state.Payment.estimated_tax,shipping_cost:state.Payment.shipping_cost,coupon:state.Coupons.coupon};};export default connect(mapStateToProps,{update_item:update_item,remove_item:remove_item,setAlert:setAlert,get_shipping_options:get_shipping_options,refresh:refresh,get_payment_total:get_payment_total,get_client_token:get_client_token,process_payment:process_payment,check_coupon:check_coupon})(Checkout);","map":{"version":3,"sources":["C:/Users/JuanD/JuanD/respaldo002/cyg/src/containers/pages/Checkout.jsx"],"names":["Layout","Navigate","connect","Link","CartItem","setAlert","update_item","remove_item","useEffect","useState","get_shipping_options","check_coupon","refresh","get_payment_total","get_client_token","process_payment","DropIn","Loader","countries","ShippingForm","Checkout","isAuthenticated","items","shipping","user","total_items","clientToken","made_payment","loading","original_price","total_after_coupon","total_amount","total_compare_amount","estimated_tax","shipping_cost","coupon","full_name","address_line_1","address_line_2","city","state_province_region","postal_zip_code","country_region","telephone_number","coupon_name","shipping_id","formData","setFormData","instance","data","setData","onChange","e","target","name","value","buy","preventDefault","requestPaymentMethod","nonce","undefined","apply_coupon","window","scrollTo","render","setRender","showItems","length","map","item","index","count","renderShipping","shipping_option","id","price","time_to_delivery","renderPaymentInfo","authorization","paypal","flow","mapStateToProps","state","Auth","Cart","Shipping","Payment","Coupons"],"mappings":"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","sourcesContent":["import Layout from '../../hocs/Layout'\nimport { Navigate } from 'react-router'\nimport { connect } from 'react-redux'\nimport { Link } from 'react-router-dom'\nimport CartItem from '../../components/cart/CartItem'\nimport { setAlert } from '../../redux/actions/alert'\nimport { update_item, remove_item } from '../../redux/actions/cart'\nimport { useEffect, useState } from 'react'\nimport {get_shipping_options} from '../../redux/actions/shipping'\nimport {check_coupon} from '../../redux/actions/coupons'\nimport {\n  refresh\n} from '../../redux/actions/auth';\n\nimport {\n  get_payment_total,\n  get_client_token,\n  process_payment\n} from '../../redux/actions/payment';\n\nimport DropIn from 'braintree-web-drop-in-react';\nimport Loader from 'react-loader-spinner';\nimport {countries} from '../../helpers/fixedCountries'\nimport ShippingForm from '../../components/checkout/ShippingForm'\n\nconst Checkout = ({\n    isAuthenticated, \n    items,\n    update_item,\n    remove_item,\n    setAlert,\n    get_shipping_options,\n    shipping,\n    refresh,\n    get_payment_total,\n    get_client_token,\n    process_payment,\n    user,\n    total_items,\n    clientToken,\n    made_payment,\n    loading,\n    original_price,\n    total_after_coupon,\n    total_amount,\n    total_compare_amount,\n    estimated_tax,\n    shipping_cost,\n    check_coupon,\n    coupon\n}) => {\n\n    const [formData, setFormData] = useState({\n        full_name: '',\n        address_line_1: '',\n        address_line_2: '',\n        city: '',\n        state_province_region: '',\n        postal_zip_code: '',\n        country_region: 'Peru',\n        telephone_number: '',\n        coupon_name: '',\n        shipping_id: 0,\n    });\n\n    const [data, setData] = useState({\n        instance: {}\n    });\n\n    const { \n        full_name,\n        address_line_1,\n        address_line_2,\n        city,\n        state_province_region,\n        postal_zip_code,\n        country_region,\n        telephone_number,\n        coupon_name,\n        shipping_id,\n    } = formData;\n\n    const onChange = e => setFormData({ ...formData, [e.target.name]: e.target.value });\n\n    const buy = async e => {\n        e.preventDefault();\n        let nonce = await data.instance.requestPaymentMethod();\n        if (coupon && coupon !== null && coupon !== undefined) {\n          process_payment(\n              nonce,\n              shipping_id,\n              coupon.name,\n              full_name,\n              address_line_1,\n              address_line_2,\n              city,\n              state_province_region,\n              postal_zip_code,\n              country_region,\n              telephone_number\n          );\n        } else {\n          process_payment(\n              nonce,\n              shipping_id,\n              '',\n              full_name,\n              address_line_1,\n              address_line_2,\n              city,\n              state_province_region,\n              postal_zip_code,\n              country_region,\n              telephone_number\n          );\n      }\n    }\n\n    const apply_coupon = async e => {\n      e.preventDefault();\n\n        check_coupon(coupon_name);\n    };\n\n    useEffect(() => {\n      window.scrollTo(0,0)\n      get_shipping_options()\n  }, [])\n\n  useEffect(() => {\n      get_client_token();\n  }, [user]);\n  \n  useEffect(() => {\n    if (coupon && coupon !== null && coupon !== undefined)\n        get_payment_total(shipping_id, coupon.name);\n    else\n        get_payment_total(shipping_id, 'default');\n  }, [shipping_id, coupon]);\n\n    const [render, setRender] = useState(false);\n\n    if(!isAuthenticated)\n        return <Navigate to='/' />;\n\n    const showItems = () => {\n        return(\n            <div>\n                {\n                    items && \n                    items !== null && \n                    items !== undefined && \n                    items.length !== 0 && \n                    items.map((item, index)=>{\n                        let count = item.count;\n                        return (\n                            <div key={index}>\n                                <CartItem \n                                    item={item}\n                                    count={count}\n                                    update_item={update_item}\n                                    remove_item={remove_item}\n                                    render={render}\n                                    setRender={setRender}\n                                    setAlert={setAlert}\n                                />\n                            </div>\n                        );\n                    })\n                }\n            </div>\n        )\n    }\n\n    const renderShipping = () => {\n        if (shipping && shipping !== null && shipping !== undefined) {\n            return (\n                <div className='mb-5'>\n                    {\n                        shipping.map((shipping_option, index) => (\n                            <div key={index}>\n                                <input\n                                    onChange={e => onChange(e)}\n                                    value={shipping_option.id}\n                                    name='shipping_id'\n                                    type='radio'\n                                    required\n                                />\n                                <label className='ml-4'>\n                                    {shipping_option.name} - ${shipping_option.price} ({shipping_option.time_to_delivery})\n                                </label>\n                            </div>\n                        ))\n                    }\n                </div>\n            );\n        }\n    };\n\n    const renderPaymentInfo = () => {\n      if (!clientToken) {\n        if (!isAuthenticated) {\n            <Link\n              to=\"/login\"\n              className=\"w-full bg-gray-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-gray-500\"\n            >\n              Login\n            </Link>\n        } else {\n          <button\n            className=\"w-full bg-indigo-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-indigo-500\"\n          >\n            <Loader\n              type='Oval'\n              color='#fff'\n              height={20}\n              widht={20}\n            />\n          </button>\n        }\n      } else {\n        return (\n          <>\n            <DropIn\n              options={{\n                  authorization: clientToken,\n                  paypal: {\n                      flow: 'vault'\n                  }\n              }}\n              onInstance={instance => (data.instance = instance)}\n            />\n            <div className=\"mt-6\">\n              {loading?<button\n                className=\"w-full bg-indigo-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-indigo-500\"\n              >\n                <Loader\n                  type='Oval'\n                  color='#fff'\n                  height={20}\n                  widht={20}\n                />\n              </button>:\n              <button\n              type=\"submit\"\n              className=\"w-full bg-green-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-green-500\"\n            >\n              Place Order\n            </button>}\n            </div>\n          </>\n        )\n      }\n    }\n\n    if (made_payment)\n        return <Navigate to='/thankyou' />;\n\n    return (\n        <Layout>\n            <div className=\"bg-white\">\n      <div className=\"max-w-2xl mx-auto pt-16 pb-24 px-4 sm:px-6 lg:max-w-7xl lg:px-8\">\n        <h1 className=\"text-3xl font-extrabold tracking-tight text-gray-900 sm:text-4xl\">Checkout</h1>\n        <div className=\"mt-12 lg:grid lg:grid-cols-12 lg:gap-x-12 lg:items-start xl:gap-x-16\">\n          <section aria-labelledby=\"cart-heading\" className=\"lg:col-span-7\">\n            <h2 id=\"cart-heading\" className=\"sr-only\">\n              Items in your shopping cart\n            </h2>\n\n            <ul className=\"border-t border-b border-gray-200 divide-y divide-gray-200\">\n              {showItems()}\n            </ul>\n          </section>\n\n          {/* Order summary */}\n\n          <ShippingForm\n              full_name={full_name}\n              address_line_1={address_line_1}\n              address_line_2={address_line_2}\n              city={city}\n              state_province_region={state_province_region}\n              postal_zip_code={postal_zip_code}\n              telephone_number={telephone_number}\n              countries={countries}\n              onChange={onChange}\n              buy={buy}\n              user={user}\n              renderShipping={renderShipping}\n              total_amount={total_amount}\n              total_after_coupon={total_after_coupon}\n              total_compare_amount={total_compare_amount}\n              estimated_tax={estimated_tax}\n              shipping_cost={shipping_cost}\n              shipping_id={shipping_id}\n              shipping={shipping}\n              renderPaymentInfo={renderPaymentInfo}\n              coupon={coupon}\n              apply_coupon={apply_coupon}\n              coupon_name={coupon_name}\n            />\n\n          \n        </div>\n      </div>\n    </div>\n        </Layout>\n    )\n}\nconst mapStateToProps = state => ({\n    isAuthenticated: state.Auth.isAuthenticated,\n    user: state.Auth.user,\n    items: state.Cart.items,\n    total_items: state.Cart.total_items,\n    shipping: state.Shipping.shipping,\n    clientToken: state.Payment.clientToken,\n    made_payment: state.Payment.made_payment,\n    loading: state.Payment.loading,\n    original_price: state.Payment.original_price,\n    total_after_coupon: state.Payment.total_after_coupon,\n    total_amount: state.Payment.total_amount,\n    total_compare_amount: state.Payment.total_compare_amount,\n    estimated_tax: state.Payment.estimated_tax,\n    shipping_cost: state.Payment.shipping_cost,\n    coupon: state.Coupons.coupon,\n})\n\nexport default connect(mapStateToProps,{\n    update_item,\n    remove_item,\n    setAlert,\n    get_shipping_options,\n    refresh,\n    get_payment_total,\n    get_client_token,\n    process_payment,\n    check_coupon\n}) (Checkout)"]},"metadata":{},"sourceType":"module"}