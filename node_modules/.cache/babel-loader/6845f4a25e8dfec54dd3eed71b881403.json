{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/JuanD/JuanD/respaldo002/cyg/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/JuanD/JuanD/respaldo002/cyg/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{SIGNUP_SUCCESS,SIGNUP_FAIL,LOGIN_SUCCESS,LOGIN_FAIL,ACTIVATION_SUCCESS,ACTIVATION_FAIL,SET_AUTH_LOADING,REMOVE_AUTH_LOADING,USER_LOADED_SUCCESS,USER_LOADED_FAIL,AUTHENTICATED_SUCCESS,AUTHENTICATED_FAIL,REFRESH_SUCCESS,REFRESH_FAIL,RESET_PASSWORD_SUCCESS,RESET_PASSWORD_FAIL,RESET_PASSWORD_CONFIRM_SUCCESS,RESET_PASSWORD_CONFIRM_FAIL,LOGOUT}from'./types';import{setAlert}from'./alert';import axios from'axios';export var check_authenticated=function check_authenticated(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!localStorage.getItem('access')){_context.next=15;break;}config={headers:{'Accept':'application/json','Content-Type':'application/json'}};body=JSON.stringify({token:localStorage.getItem('access')});_context.prev=3;_context.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/jwt/verify/\"),body,config);case 6:res=_context.sent;if(res.status===200){dispatch({type:AUTHENTICATED_SUCCESS});}else{dispatch({type:AUTHENTICATED_FAIL});}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](3);dispatch({type:AUTHENTICATED_FAIL});case 13:_context.next=16;break;case 15:dispatch({type:AUTHENTICATED_FAIL});case 16:case\"end\":return _context.stop();}}},_callee,null,[[3,10]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var signup=function signup(first_name,last_name,email,password,re_password){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch({type:SET_AUTH_LOADING});config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({first_name:first_name,last_name:last_name,email:email,password:password,re_password:re_password});_context2.prev=3;_context2.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/users/\"),body,config);case 6:res=_context2.sent;if(res.status===201){dispatch({type:SIGNUP_SUCCESS,payload:res.data});dispatch(setAlert('Te enviamos un correo, por favor activa tu cuenta. Revisa el correo de spam','green'));}else{dispatch({type:SIGNUP_FAIL});dispatch(setAlert('Error al crear cuenta','red'));}dispatch({type:REMOVE_AUTH_LOADING});_context2.next=16;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](3);dispatch({type:SIGNUP_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error conectando con el servidor, intenta mas tarde.','red'));case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[3,11]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var load_user=function load_user(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!localStorage.getItem('access')){_context3.next=14;break;}config={headers:{'Authorization':\"JWT \".concat(localStorage.getItem('access')),'Accept':'application/json'}};_context3.prev=2;_context3.next=5;return axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/users/me/\"),config);case 5:res=_context3.sent;if(res.status===200){dispatch({type:USER_LOADED_SUCCESS,payload:res.data});}else{dispatch({type:USER_LOADED_FAIL});}_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](2);dispatch({type:USER_LOADED_FAIL});case 12:_context3.next=15;break;case 14:dispatch({type:USER_LOADED_FAIL});case 15:case\"end\":return _context3.stop();}}},_callee3,null,[[2,9]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var login=function login(email,password){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:dispatch({type:SET_AUTH_LOADING});config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email,password:password});_context4.prev=3;_context4.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/jwt/create/\"),body,config);case 6:res=_context4.sent;if(res.status===200){dispatch({type:LOGIN_SUCCESS,payload:res.data});dispatch(load_user());dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Inicio de sesión con éxito','green'));}else{dispatch({type:LOGIN_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error al iniciar sesion.','red'));}_context4.next=15;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](3);dispatch({type:LOGIN_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error al iniciar sesion. Intenta mas tarde','red'));case 15:case\"end\":return _context4.stop();}}},_callee4,null,[[3,10]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var activate=function activate(uid,token){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:dispatch({type:SET_AUTH_LOADING});config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({uid:uid,token:token});_context5.prev=3;_context5.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/users/activation/\"),body,config);case 6:res=_context5.sent;if(res.status===204){dispatch({type:ACTIVATION_SUCCESS});dispatch(setAlert('Cuenta activada correctamente','green'));}else{dispatch({type:ACTIVATION_FAIL});dispatch(setAlert('Error activando cuenta','red'));}dispatch({type:REMOVE_AUTH_LOADING});_context5.next=16;break;case 11:_context5.prev=11;_context5.t0=_context5[\"catch\"](3);dispatch({type:ACTIVATION_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error al conectar con el servidor, intenta mas tarde.','red'));case 16:case\"end\":return _context5.stop();}}},_callee5,null,[[3,11]]);}));return function(_x5){return _ref5.apply(this,arguments);};}();};export var refresh=function refresh(){return/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(!localStorage.getItem('refresh')){_context6.next=15;break;}config={headers:{'Accept':'application/json','Content-Type':'application/json'}};body=JSON.stringify({refresh:localStorage.getItem('refresh')});_context6.prev=3;_context6.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/jwt/refresh/\"),body,config);case 6:res=_context6.sent;if(res.status===200){dispatch({type:REFRESH_SUCCESS,payload:res.data});}else{dispatch({type:REFRESH_FAIL});}_context6.next=13;break;case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](3);dispatch({type:REFRESH_FAIL});case 13:_context6.next=16;break;case 15:dispatch({type:REFRESH_FAIL});case 16:case\"end\":return _context6.stop();}}},_callee6,null,[[3,10]]);}));return function(_x6){return _ref6.apply(this,arguments);};}();};export var reset_password=function reset_password(email){return/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:dispatch({type:SET_AUTH_LOADING});config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email});_context7.prev=3;_context7.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/users/reset_password/\"),body,config);case 6:res=_context7.sent;if(res.status===204){dispatch({type:RESET_PASSWORD_SUCCESS});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Password reset email sent','green'));}else{dispatch({type:RESET_PASSWORD_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error sending password reset email','red'));}_context7.next=15;break;case 10:_context7.prev=10;_context7.t0=_context7[\"catch\"](3);dispatch({type:RESET_PASSWORD_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error sending password reset email','red'));case 15:case\"end\":return _context7.stop();}}},_callee7,null,[[3,10]]);}));return function(_x7){return _ref7.apply(this,arguments);};}();};export var reset_password_confirm=function reset_password_confirm(uid,token,new_password,re_new_password){return/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:dispatch({type:SET_AUTH_LOADING});config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({uid:uid,token:token,new_password:new_password,re_new_password:re_new_password});if(!(new_password!==re_new_password)){_context8.next=9;break;}dispatch({type:RESET_PASSWORD_CONFIRM_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Passwords do not match','red'));_context8.next=21;break;case 9:_context8.prev=9;_context8.next=12;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/users/reset_password_confirm/\"),body,config);case 12:res=_context8.sent;if(res.status===204){dispatch({type:RESET_PASSWORD_CONFIRM_SUCCESS});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Password has been reset successfully','green'));}else{dispatch({type:RESET_PASSWORD_CONFIRM_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error resetting your password','red'));}_context8.next=21;break;case 16:_context8.prev=16;_context8.t0=_context8[\"catch\"](9);dispatch({type:RESET_PASSWORD_CONFIRM_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error resetting your password','red'));case 21:case\"end\":return _context8.stop();}}},_callee8,null,[[9,16]]);}));return function(_x8){return _ref8.apply(this,arguments);};}();};export var logout=function logout(){return function(dispatch){dispatch({type:LOGOUT});dispatch(setAlert('Succesfully logged out','green'));};};","map":{"version":3,"sources":["C:/Users/JuanD/JuanD/respaldo002/cyg/src/redux/actions/auth.js"],"names":["SIGNUP_SUCCESS","SIGNUP_FAIL","LOGIN_SUCCESS","LOGIN_FAIL","ACTIVATION_SUCCESS","ACTIVATION_FAIL","SET_AUTH_LOADING","REMOVE_AUTH_LOADING","USER_LOADED_SUCCESS","USER_LOADED_FAIL","AUTHENTICATED_SUCCESS","AUTHENTICATED_FAIL","REFRESH_SUCCESS","REFRESH_FAIL","RESET_PASSWORD_SUCCESS","RESET_PASSWORD_FAIL","RESET_PASSWORD_CONFIRM_SUCCESS","RESET_PASSWORD_CONFIRM_FAIL","LOGOUT","setAlert","axios","check_authenticated","dispatch","localStorage","getItem","config","headers","body","JSON","stringify","token","post","process","env","REACT_APP_API_URL","res","status","type","signup","first_name","last_name","email","password","re_password","payload","data","load_user","get","login","activate","uid","refresh","reset_password","reset_password_confirm","new_password","re_new_password","logout"],"mappings":"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","sourcesContent":["import {\n    SIGNUP_SUCCESS,\n    SIGNUP_FAIL,\n    LOGIN_SUCCESS,\n    LOGIN_FAIL,\n    ACTIVATION_SUCCESS,\n    ACTIVATION_FAIL,\n    SET_AUTH_LOADING,\n    REMOVE_AUTH_LOADING,\n    USER_LOADED_SUCCESS,\n    USER_LOADED_FAIL,\n    AUTHENTICATED_SUCCESS,\n    AUTHENTICATED_FAIL,\n    REFRESH_SUCCESS,\n    REFRESH_FAIL,\n    RESET_PASSWORD_SUCCESS,\n    RESET_PASSWORD_FAIL,\n    RESET_PASSWORD_CONFIRM_SUCCESS,\n    RESET_PASSWORD_CONFIRM_FAIL,\n    LOGOUT\n} from './types'\nimport { setAlert } from './alert';\nimport axios from 'axios'\n\nexport const check_authenticated = () => async dispatch => {\n    if(localStorage.getItem('access')){\n        const config = {\n            headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json'\n            }\n        };\n\n        const body = JSON.stringify({\n            token: localStorage.getItem('access')\n        });\n\n        try {\n            const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/jwt/verify/`, body, config);\n\n            if (res.status === 200) {\n                dispatch({\n                    type: AUTHENTICATED_SUCCESS\n                });\n            } else {\n                dispatch({\n                    type: AUTHENTICATED_FAIL\n                });\n            }\n        } catch(err){\n            dispatch({\n                type: AUTHENTICATED_FAIL\n            });\n        }\n    } else {\n        dispatch({\n            type: AUTHENTICATED_FAIL\n        });\n    }\n}\n\nexport const signup = (first_name, last_name, email, password, re_password) => async dispatch => {\n    dispatch({\n        type: SET_AUTH_LOADING\n    });\n\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    };\n\n    const body = JSON.stringify({\n        first_name,\n        last_name,\n        email,\n        password,\n        re_password\n    });\n\n    try {\n        const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/users/`, body, config);\n\n        if (res.status === 201) {\n            dispatch({\n                type: SIGNUP_SUCCESS,\n                payload: res.data\n            });\n            dispatch(setAlert('Te enviamos un correo, por favor activa tu cuenta. Revisa el correo de spam','green'))\n        } else {\n            dispatch({\n                type: SIGNUP_FAIL\n            });\n            dispatch(setAlert('Error al crear cuenta', 'red'));\n        }\n        dispatch({\n            type: REMOVE_AUTH_LOADING\n        });\n    } catch (err) {\n        dispatch({\n            type: SIGNUP_FAIL\n        });\n        dispatch({\n            type: REMOVE_AUTH_LOADING\n        });\n        dispatch(setAlert('Error conectando con el servidor, intenta mas tarde.', 'red'));\n    }\n};\n\nexport const load_user = () => async dispatch => {\n    if(localStorage.getItem('access')){\n        const config = {\n            headers: {\n                'Authorization': `JWT ${localStorage.getItem('access')}`,\n                'Accept': 'application/json'\n            }\n        };\n\n        try {\n            const res = await axios.get(`${process.env.REACT_APP_API_URL}/auth/users/me/`, config);\n        \n            if (res.status === 200) {\n                dispatch({\n                    type: USER_LOADED_SUCCESS,\n                    payload: res.data\n                });\n            } else {\n                dispatch({\n                    type: USER_LOADED_FAIL\n                });\n            }\n        }\n        catch(err){\n            dispatch({\n                type: USER_LOADED_FAIL\n            });\n        }\n    } else {\n        dispatch({\n            type: USER_LOADED_FAIL\n        });\n    }\n}\n\nexport const login = (email, password) => async dispatch => {\n    dispatch({\n        type: SET_AUTH_LOADING\n    });\n\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    };\n\n    const body = JSON.stringify({\n        email,\n        password\n    });\n\n    try {\n        const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/jwt/create/`, body, config);\n    \n        if (res.status === 200) {\n            dispatch({\n                type: LOGIN_SUCCESS,\n                payload: res.data\n            });\n            dispatch(load_user());\n            dispatch({\n                type: REMOVE_AUTH_LOADING\n            });\n            dispatch(setAlert('Inicio de sesión con éxito', 'green'));\n        } else {\n            dispatch({\n                type: LOGIN_FAIL\n            });\n            dispatch({\n                type: REMOVE_AUTH_LOADING\n            });\n            dispatch(setAlert('Error al iniciar sesion.', 'red'));\n        }\n    }\n    catch(err){\n        dispatch({\n            type: LOGIN_FAIL\n        });\n        dispatch({\n            type: REMOVE_AUTH_LOADING\n        });\n        dispatch(setAlert('Error al iniciar sesion. Intenta mas tarde', 'red'));\n    }\n}\n\nexport const activate = (uid, token) => async dispatch => {\n    dispatch({\n        type: SET_AUTH_LOADING\n    });\n\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    };\n\n    const body = JSON.stringify({\n        uid,\n        token\n    });\n\n    try {\n        const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/users/activation/`, body, config);\n    \n        if (res.status === 204) {\n            dispatch({\n                type: ACTIVATION_SUCCESS\n            });\n            dispatch(setAlert('Cuenta activada correctamente', 'green'));\n        } else {\n            dispatch({\n                type: ACTIVATION_FAIL\n            });\n            dispatch(setAlert('Error activando cuenta', 'red'));\n        }\n        dispatch({\n            type: REMOVE_AUTH_LOADING\n        });\n    }\n    catch(err){\n        dispatch({\n            type: ACTIVATION_FAIL\n        });\n        dispatch({\n            type: REMOVE_AUTH_LOADING\n        });\n        dispatch(setAlert('Error al conectar con el servidor, intenta mas tarde.', 'red'));\n    }\n};\n\nexport const refresh = () => async dispatch => {\n    if (localStorage.getItem('refresh')) {\n        const config = {\n            headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json'\n            }\n        };\n\n        const body = JSON.stringify({\n            refresh: localStorage.getItem('refresh')\n        });\n\n        try {\n            const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/jwt/refresh/`, body, config);\n            \n            if (res.status === 200) {\n                dispatch({\n                    type: REFRESH_SUCCESS,\n                    payload: res.data\n                });\n            } else {\n                dispatch({\n                    type: REFRESH_FAIL\n                });\n            }\n        }catch(err){\n            dispatch({\n                type: REFRESH_FAIL\n            });\n        }\n    } else {\n        dispatch({\n            type: REFRESH_FAIL\n        });\n    }\n}\n\nexport const reset_password = (email) => async dispatch => {\n    dispatch({\n        type: SET_AUTH_LOADING\n    });\n\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    };\n\n    const body = JSON.stringify({ email });\n\n    try{\n        const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/users/reset_password/`, body, config);\n        \n        if (res.status === 204) {\n            dispatch({\n                type: RESET_PASSWORD_SUCCESS\n            });\n            dispatch({\n                type: REMOVE_AUTH_LOADING\n            });\n            dispatch(setAlert('Password reset email sent', 'green'));\n        } else {\n            dispatch({\n                type: RESET_PASSWORD_FAIL\n            });\n            dispatch({\n                type: REMOVE_AUTH_LOADING\n            });\n            dispatch(setAlert('Error sending password reset email', 'red'));\n        }\n    }\n    catch(err){\n        dispatch({\n            type: RESET_PASSWORD_FAIL\n        });\n        dispatch({\n            type: REMOVE_AUTH_LOADING\n        });\n        dispatch(setAlert('Error sending password reset email', 'red'));\n    }\n}\n\nexport const reset_password_confirm = (uid, token, new_password, re_new_password) => async dispatch => {\n    dispatch({\n        type: SET_AUTH_LOADING\n    });\n\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    };\n\n    const body = JSON.stringify({\n        uid,\n        token,\n        new_password,\n        re_new_password\n    });\n\n    if (new_password !== re_new_password) {\n        dispatch({\n            type: RESET_PASSWORD_CONFIRM_FAIL\n        });\n        dispatch({\n            type: REMOVE_AUTH_LOADING\n        });\n        dispatch(setAlert('Passwords do not match', 'red'));\n    } else {\n        try {\n            const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/users/reset_password_confirm/`, body, config);\n        \n            if (res.status === 204) {\n                dispatch({\n                    type: RESET_PASSWORD_CONFIRM_SUCCESS\n                });\n                dispatch({\n                    type: REMOVE_AUTH_LOADING\n                });\n                dispatch(setAlert('Password has been reset successfully', 'green'));\n            } else {\n                dispatch({\n                    type: RESET_PASSWORD_CONFIRM_FAIL\n                });\n                dispatch({\n                    type: REMOVE_AUTH_LOADING\n                });\n                dispatch(setAlert('Error resetting your password', 'red'));\n            }\n        } catch(err){\n            dispatch({\n                type: RESET_PASSWORD_CONFIRM_FAIL\n            });\n            dispatch({\n                type: REMOVE_AUTH_LOADING\n            });\n            dispatch(setAlert('Error resetting your password', 'red'));\n        }\n    }\n}\n\nexport const logout = () => dispatch => {\n    dispatch({\n        type: LOGOUT\n    });\n    dispatch(setAlert('Succesfully logged out', 'green'));\n}"]},"metadata":{},"sourceType":"module"}